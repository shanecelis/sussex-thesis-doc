#!/usr/bin/perl
# mr
# make mathematica ready

@collect = ();

while (<>) {
    if (! /^\w*$/) {
        # if (/(?<!\\)\{(\\\{|\\\}|[^\{\}]|(?<!\\)\{.*(?<!\\)\})*(?<!\\)\}/ ) {
        #     print "WOAH! $1 $2 $3\n";
        # }
        # if (/COS(?<!\\)\((\\\(|\\\)|[^\(\)]|(?<!\\)\(.*(?<!\\)\))*(?<!\\)\)/) {
        #     print "YEAH! $1\n";
        # }
        next if (/^\s*#/);
        if (/^!(.*)$/) {
            print "$1";
            next;
        }
        s/^.*=//;
        #s/^.*ZERO\[\d+\] =/0 == /ig;
        #s/Result = //g;
        s/>//g;
        s/([^\w][qu]\d*'*)/\1\[t\]/g;
        s/ACOS((?<!\\)\((\\\(|\\\)|[^\(\)]|(?<!\\)\(.*(?<!\\)\))*(?<!\\)\))/ArcCos\[\1\]/g;
        s/ASIN((?<!\\)\((\\\(|\\\)|[^\(\)]|(?<!\\)\(.*(?<!\\)\))*(?<!\\)\))/ArcSin\[\1\]/g;
        s/COS((?<!\\)\((\\\(|\\\)|[^\(\)]|(?<!\\)\(.*(?<!\\)\))*(?<!\\)\))/Cos\[\1\]/g;
        s/SIN((?<!\\)\((\\\(|\\\)|[^\(\)]|(?<!\\)\(.*(?<!\\)\))*(?<!\\)\))/Sin\[\1\]/g;
        s/ABS((?<!\\)\((\\\(|\\\)|[^\(\)]|(?<!\\)\(.*(?<!\\)\))*(?<!\\)\))/Abs\[\1\]/g;
        #s/'/'[t]/g;
        push @collect, $_;
    }
}
print "{";
print (join(',', @collect));
print "};\n";
    
