(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 8.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[     51306,       1365]
NotebookOptionsPosition[     48155,       1257]
NotebookOutlinePosition[     48533,       1274]
CellTagsIndexPosition[     48490,       1271]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Code", "Title",
 CellChangeTimes->{{3.5213998971328173`*^9, 3.521399897507134*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"importALPSGenes", "[", "filename_", "]"}], ":=", 
  RowBox[{"Select", "[", 
   RowBox[{
    RowBox[{"Import", "[", 
     RowBox[{"filename", ",", "\"\<Table\>\""}], "]"}], ",", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"Length", "[", "#", "]"}], " ", "\[Equal]", " ", "geneCount"}], 
     "&"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.520802448830057*^9, 3.520802462143795*^9}, {
  3.521232446915476*^9, 3.521232462273196*^9}, {3.521232701485577*^9, 
  3.521232708018983*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"importALPSOut", "[", "filename_", "]"}], " ", ":=", " ", 
  RowBox[{"Select", "[", 
   RowBox[{
    RowBox[{"Import", "[", 
     RowBox[{"filename", ",", "\"\<Table\>\""}], "]"}], ",", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"Length", "[", "#", "]"}], " ", "\[Equal]", " ", "3"}], "&"}]}],
    "]"}]}]], "Input",
 CellChangeTimes->{{3.521307255742989*^9, 3.521307279760066*^9}, {
  3.521319466586463*^9, 3.521319466642239*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"importGenesFromRun", "[", 
   RowBox[{"resultName_", ",", " ", "expName_", ",", " ", "runNo_"}], "]"}], 
  " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "file", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"file", "=", " ", 
      RowBox[{"Last", "[", 
       RowBox[{"FileNames", "[", 
        RowBox[{"resultName", " ", "<>", " ", "\"\</\>\"", " ", "<>", " ", 
         RowBox[{"ToString", "[", "expName", "]"}], " ", "<>", " ", 
         "\"\</\>\"", " ", "<>", " ", 
         RowBox[{"ToString", "[", "runNo", "]"}], " ", "<>", " ", 
         "\"\<-*.pop\>\""}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"importALPSGenes", "[", "file", "]"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.521391018164626*^9, 3.521391039686798*^9}, {
  3.521391105367066*^9, 3.52139123456907*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"importResults", "[", "directoryName_", "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "files", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"files", " ", "=", " ", 
      RowBox[{"FileNames", "[", 
       RowBox[{"\"\<*.out\>\"", ",", 
        RowBox[{"{", "directoryName", "}"}], ",", "2"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"combineResults", "[", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"FileBaseName", "[", 
            RowBox[{"DirectoryName", "[", "#", "]"}], "]"}], " ", ",", " ", 
           RowBox[{"importALPSOut", "[", "#", "]"}]}], "}"}], "&"}], ",", " ",
         "files"}], "]"}], "]"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.521307372713708*^9, 3.521307382437463*^9}, {
  3.5213076345014763`*^9, 3.521307685592586*^9}, {3.521307943320055*^9, 
  3.5213079446707697`*^9}, {3.521308147379828*^9, 3.521308192640477*^9}, {
  3.521308458523879*^9, 3.521308472793804*^9}, {3.521308516503956*^9, 
  3.521308522117751*^9}, {3.521309224385621*^9, 3.521309228849636*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"chartOfResults", "[", "directoryName_", "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "res", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"res", " ", "=", " ", 
      RowBox[{"importResults", "[", "directoryName", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"BarChart", "[", 
      RowBox[{
       RowBox[{"Map", "[", 
        RowBox[{"Mean", ",", 
         RowBox[{"values", "[", "res", "]"}]}], "]"}], ",", " ", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"ChartLegends", " ", "\[Rule]", " ", 
        RowBox[{"keys", "[", "res", "]"}]}], ",", " ", 
       RowBox[{"ChartStyle", " ", "\[Rule]", " ", "\"\<DarkRainbow\>\""}]}], 
      "]"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.521307881209545*^9, 3.521307937928589*^9}, {
  3.521308283433134*^9, 3.521308316665786*^9}, {3.5213092615028477`*^9, 
  3.5213092736327667`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"combineResultsHelper", "[", "splitResult_", "]"}], " ", ":=", " ", 
  
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"name", ",", " ", "justData"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"name", " ", "=", " ", 
      RowBox[{"splitResult", "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"justData", " ", "=", " ", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"#", "[", 
          RowBox[{"[", "2", "]"}], "]"}], "&"}], ",", " ", "splitResult"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"name", " ", "\[Rule]", "  ", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"#", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{"-", "1"}], ",", 
            RowBox[{"-", "1"}]}], "]"}], "]"}], "&"}], ",", " ", "justData"}],
        "]"}]}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.521309003859967*^9, 3.521309092887988*^9}, {
  3.5213091422014017`*^9, 3.5213091462647953`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"combineResults", "[", "results_", "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Map", "[", 
     RowBox[{"combineResultsHelper", ",", " ", 
      RowBox[{"SplitBy", "[", 
       RowBox[{"results", ",", " ", 
        RowBox[{
         RowBox[{"#", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "&"}]}], "]"}]}], "]"}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.521308558826709*^9, 3.5213087703925753`*^9}, {
  3.521308973596908*^9, 3.521308986518745*^9}, {3.5213091010546207`*^9, 
  3.5213091203151093`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"indexOfMinimum", "[", 
   RowBox[{"fun_", ",", " ", "inputs_"}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"outputs", ",", " ", "min"}], "}"}], ",", "\[IndentingNewLine]", 
    
    RowBox[{
     RowBox[{"outputs", " ", "=", " ", 
      RowBox[{"Map", "[", 
       RowBox[{"fun", ",", " ", "inputs"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"min", " ", "=", " ", 
      RowBox[{"Min", "[", "outputs", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Flatten", "[", 
      RowBox[{"Position", "[", 
       RowBox[{"outputs", ",", " ", "min"}], "]"}], "]"}]}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.5213965236889277`*^9, 3.521396579166464*^9}, {
  3.5213966127588577`*^9, 3.5213966144701347`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"indexOfMaximum", "[", 
   RowBox[{"fun_", ",", " ", "inputs_"}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"outputs", ",", " ", "min"}], "}"}], ",", "\[IndentingNewLine]", 
    
    RowBox[{
     RowBox[{"outputs", " ", "=", " ", 
      RowBox[{"Map", "[", 
       RowBox[{"fun", ",", " ", "inputs"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"min", " ", "=", " ", 
      RowBox[{"Max", "[", "outputs", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Flatten", "[", 
      RowBox[{"Position", "[", 
       RowBox[{"outputs", ",", " ", "min"}], "]"}], "]"}]}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.5213965236889277`*^9, 3.521396579166464*^9}, {
  3.5213966127588577`*^9, 3.5213966144701347`*^9}, {3.5216782555856333`*^9, 
  3.5216782620590277`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"importMinGene", "[", 
   RowBox[{"filename_", ",", " ", "fitnessForGene_"}], "]"}], " ", ":=", " ", 
  
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"genes", ",", " ", "index", ",", "  ", "indexes"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"genes", " ", "=", " ", 
      RowBox[{"importALPSGenes", "[", "filename", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"indexes", " ", "=", " ", 
      RowBox[{"indexOfMinimum", "[", 
       RowBox[{"fitnessForGene", ",", " ", "genes"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "indexes", "]"}], " ", ">", " ", "1"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Message", "[", 
        RowBox[{"importBestGenes", "::", "notuniq"}], "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"index", " ", "=", " ", 
      RowBox[{"First", "[", "indexes", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"genes", "[", 
      RowBox[{"[", "index", "]"}], "]"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.521588268027218*^9, 3.521588337046982*^9}, {
  3.5215886658503*^9, 3.521588666911128*^9}, {3.5215888653856153`*^9, 
  3.521588880848168*^9}, {3.521591450361936*^9, 3.521591505874373*^9}, {
  3.52167911366262*^9, 3.5216791163320503`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"importMaxGene", "[", 
   RowBox[{"filename_", ",", " ", "fitnessForGene_"}], "]"}], " ", ":=", " ", 
  
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"genes", ",", " ", "index", ",", "  ", "indexes"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"genes", " ", "=", " ", 
      RowBox[{"importALPSGenes", "[", "filename", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"indexes", " ", "=", " ", 
      RowBox[{"indexOfMaximum", "[", 
       RowBox[{"fitnessForGene", ",", " ", "genes"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "indexes", "]"}], " ", ">", " ", "1"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Message", "[", 
        RowBox[{"importBestGenes", "::", "notuniq"}], "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"index", " ", "=", " ", 
      RowBox[{"First", "[", "indexes", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"genes", "[", 
      RowBox[{"[", "index", "]"}], "]"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.521588268027218*^9, 3.521588337046982*^9}, {
   3.5215886658503*^9, 3.521588666911128*^9}, {3.5215888653856153`*^9, 
   3.521588880848168*^9}, {3.521591450361936*^9, 3.521591505874373*^9}, {
   3.5216782531161957`*^9, 3.521678277372533*^9}, 3.521679105301281*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Read Results", "Title",
 CellChangeTimes->{{3.5213072085003843`*^9, 3.521307210137642*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"target", " ", "=", " ", 
  RowBox[{"{", 
   RowBox[{"0", ",", " ", "0.1"}], "}"}]}]], "Input",
 CellChangeTimes->{{3.522701650745943*^9, 3.522701651267498*^9}, {
  3.522863619800641*^9, 3.522863623078445*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", "0.1`"}], "}"}]], "Output",
 CellChangeTimes->{3.522701651556888*^9, 3.5228636242435226`*^9}]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"fitness", " ", "=", " ", 
   RowBox[{
    RowBox[{"fitnessToTarget", "[", 
     RowBox[{"#", ",", " ", "target", ",", " ", "Ao", ",", " ", "1"}], "]"}], 
    "&"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"fitnessData", " ", "=", " ", 
   RowBox[{
    RowBox[{"fitnessToTargetData", "[", 
     RowBox[{"#", ",", " ", "target", ",", " ", "Ao", ",", " ", "1"}], "]"}], 
    "&"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.5215890001298447`*^9, 3.521589003119111*^9}, {
  3.52158937248549*^9, 3.521589372837069*^9}, {3.5215894898393993`*^9, 
  3.521589491508918*^9}, {3.521591397080393*^9, 3.52159139828054*^9}, {
  3.521658488793014*^9, 3.521658499026498*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"fitness", " ", "=", " ", 
   RowBox[{
    RowBox[{"fitnessToTarget", "[", 
     RowBox[{"#", ",", " ", "target", ",", " ", "Ap", ",", " ", "1"}], "]"}], 
    "&"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"fitnessData", " ", "=", " ", 
   RowBox[{
    RowBox[{"fitnessToTargetData", "[", 
     RowBox[{"#", ",", " ", "target", ",", " ", "Ap", ",", " ", "1"}], "]"}], 
    "&"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.5215890001298447`*^9, 3.521589003119111*^9}, {
  3.52158937248549*^9, 3.521589372837069*^9}, {3.5215894898393993`*^9, 
  3.521589491508918*^9}, {3.521591397080393*^9, 3.52159139828054*^9}, {
  3.521658488793014*^9, 3.521658499026498*^9}, {3.522701643282716*^9, 
  3.522701647188715*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"fitness", " ", "=", " ", 
   RowBox[{
    RowBox[{"fitnessForSpeed", "[", 
     RowBox[{"#", ",", " ", "Bp", ",", " ", "1"}], "]"}], "&"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fitnessData", " ", "=", " ", 
   RowBox[{
    RowBox[{"fitnessForSpeedData", "[", 
     RowBox[{"#", ",", " ", "Bp", ",", " ", "1"}], "]"}], "&"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.521678312999889*^9, 3.5216783371215277`*^9}, {
  3.521679267155078*^9, 3.521679278281352*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"fitness", " ", "=", " ", 
   RowBox[{
    RowBox[{"fitnessForSpeed", "[", 
     RowBox[{"#", ",", " ", "Ap", ",", " ", "1"}], "]"}], "&"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fitnessData", " ", "=", " ", 
   RowBox[{
    RowBox[{"fitnessForSpeedData", "[", 
     RowBox[{"#", ",", " ", "Ap", ",", " ", "1"}], "]"}], "&"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.521678312999889*^9, 3.5216783371215277`*^9}, {
  3.521679267155078*^9, 3.521679278281352*^9}, {3.522701543806849*^9, 
  3.522701548605122*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"chartOfResults", "[", "\"\<res1\>\"", "]"}]], "Input",
 CellChangeTimes->{{3.5213079193516912`*^9, 3.521307923284663*^9}}],

Cell[BoxData[
 TemplateBox[{GraphicsBox[{{
      Opacity[0], 
      PointBox[{{0.4545454545454546, 0.}}]}, {
      RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
      EdgeForm[
       Opacity[0.7]], {}, {
       RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
       EdgeForm[
        Opacity[0.7]], {
        RGBColor[0.237736, 0.340215, 0.575113], 
        EdgeForm[
         Opacity[0.7]], 
        TagBox[
         TooltipBox[
          TagBox[
           DynamicBox[{
             FEPrivate`If[
              CurrentValue["MouseOver"], 
              EdgeForm[{
                GrayLevel[0.5], 
                AbsoluteThickness[1.5], 
                Opacity[0.66]}], {}, {}], 
             
             RectangleBox[{0.5454545454545454, 0.}, {1.4545454545454546`, 
              4498.}, "RoundingRadius" -> 0]}, 
            ImageSizeCache -> {{33.396474953617805`, 83.36122448979592}, {
             56.154551699195444`, 97.48941288859032}}], StatusArea[#, 4498]& ,
            TagBoxNote -> "4498"], 
          StyleBox["4498", {
            GrayLevel[0]}, StripOnInput -> False]], Annotation[#, 
          Style[4498, {
            GrayLevel[0]}], "Tooltip"]& ]}, {
        RGBColor[0.264425, 0.423024, 0.3849], 
        EdgeForm[
         Opacity[0.7]], 
        TagBox[
         TooltipBox[
          TagBox[
           DynamicBox[{
             FEPrivate`If[
              CurrentValue["MouseOver"], 
              EdgeForm[{
                GrayLevel[0.5], 
                AbsoluteThickness[1.5], 
                Opacity[0.66]}], {}, {}], 
             
             RectangleBox[{1.5454545454545454`, 0.}, {2.4545454545454546`, 
              3254.}, "RoundingRadius" -> 0]}, 
            ImageSizeCache -> {{87.25769944341371, 137.22244897959183`}, {
             67.30985790631132, 97.48941288859032}}], StatusArea[#, 3254]& , 
           TagBoxNote -> "3254"], 
          StyleBox["3254", {
            GrayLevel[0]}, StripOnInput -> False]], Annotation[#, 
          Style[3254, {
            GrayLevel[0]}], "Tooltip"]& ]}, {
        RGBColor[0.416394, 0.555345, 0.24182], 
        EdgeForm[
         Opacity[0.7]], 
        TagBox[
         TooltipBox[
          TagBox[
           DynamicBox[{
             FEPrivate`If[
              CurrentValue["MouseOver"], 
              EdgeForm[{
                GrayLevel[0.5], 
                AbsoluteThickness[1.5], 
                Opacity[0.66]}], {}, {}], 
             
             RectangleBox[{2.5454545454545454`, 0.}, {3.4545454545454546`, 
              8342.}, "RoundingRadius" -> 0]}, 
            ImageSizeCache -> {{141.11892393320966`, 191.08367346938775`}, {
             21.684296827689465`, 97.48941288859032}}], StatusArea[#, 8342]& ,
            TagBoxNote -> "8342"], 
          StyleBox["8342", {
            GrayLevel[0]}, StripOnInput -> False]], Annotation[#, 
          Style[8342, {
            GrayLevel[0]}], "Tooltip"]& ]}, {
        RGBColor[0.813033, 0.766292, 0.303458], 
        EdgeForm[
         Opacity[0.7]], 
        TagBox[
         TooltipBox[
          TagBox[
           DynamicBox[{
             FEPrivate`If[
              CurrentValue["MouseOver"], 
              EdgeForm[{
                GrayLevel[0.5], 
                AbsoluteThickness[1.5], 
                Opacity[0.66]}], {}, {}], 
             
             RectangleBox[{3.5454545454545454`, 0.}, {4.454545454545454, 
              22273.}, "RoundingRadius" -> 0]}, 
            ImageSizeCache -> {{194.98014842300557`, 
             244.94489795918366`}, {-103.23899157370226`, 
             97.48941288859032}}], StatusArea[#, 22273]& , TagBoxNote -> 
           "22273"], 
          StyleBox["22273", {
            GrayLevel[0]}, StripOnInput -> False]], Annotation[#, 
          Style[22273, {
            GrayLevel[0]}], "Tooltip"]& ]}, {
        RGBColor[0.812807, 0.518694, 0.303459], 
        EdgeForm[
         Opacity[0.7]], 
        TagBox[
         TooltipBox[
          TagBox[
           DynamicBox[{
             FEPrivate`If[
              CurrentValue["MouseOver"], 
              EdgeForm[{
                GrayLevel[0.5], 
                AbsoluteThickness[1.5], 
                Opacity[0.66]}], {}, {}], 
             
             RectangleBox[{4.545454545454545, 0.}, {5.454545454545454, 1595.},
               "RoundingRadius" -> 0]}, 
            ImageSizeCache -> {{248.84137291280146`, 298.8061224489795}, {
             82.18658861178179, 97.48941288859032}}], StatusArea[#, 1595]& , 
           TagBoxNote -> "1595"], 
          StyleBox["1595", {
            GrayLevel[0]}, StripOnInput -> False]], Annotation[#, 
          Style[1595, {
            GrayLevel[0]}], "Tooltip"]& ]}, {
        RGBColor[0.72987, 0.239399, 0.230961], 
        EdgeForm[
         Opacity[0.7]], 
        TagBox[
         TooltipBox[
          TagBox[
           DynamicBox[{
             FEPrivate`If[
              CurrentValue["MouseOver"], 
              EdgeForm[{
                GrayLevel[0.5], 
                AbsoluteThickness[1.5], 
                Opacity[0.66]}], {}, {}], 
             
             RectangleBox[{5.545454545454545, 0.}, {6.454545454545454, 6525.},
               "RoundingRadius" -> 0]}, 
            ImageSizeCache -> {{302.70259740259735`, 352.66734693877544`}, {
             37.977859028919006`, 97.48941288859032}}], StatusArea[#, 6525]& ,
            TagBoxNote -> "6525"], 
          StyleBox["6525", {
            GrayLevel[0]}, StripOnInput -> False]], Annotation[#, 
          Style[6525, {
            GrayLevel[0]}], 
          "Tooltip"]& ]}}, {}, {}}, {}, {{{{{{{}, {}}, {}}, {{{}, {}}, {}}, \
{{{}, {}}, {}}, {{{}, {}}, {}}, {{{}, {}}, {}}, {{{}, {}}, {}}}, {}}, {}}, \
{}}, 
     GraphicsGroupBox[{
       GrayLevel[0], 
       StyleBox[
        LineBox[{{{0.5454545454545454, 0.}, 
           Offset[{0, -4}, {0.5454545454545454, 0.}]}, {{6.454545454545454, 
           0.}, 
           Offset[{0, -4}, {6.454545454545454, 0.}]}}], Antialiasing -> 
        False]}]}, AspectRatio -> 
    NCache[GoldenRatio^(-1), 0.6180339887498948], Axes -> {True, True}, 
    AxesOrigin -> {0.4545454545454546, 0}, 
    FrameTicks -> {{Automatic, Automatic}, {Automatic, Automatic}}, 
    GridLines -> {None, None}, PlotRangePadding -> Scaled[0.02], 
    Ticks -> {None, Automatic}],FrameBox[
    StyleBox[
     TagBox[
      GridBox[{{
         TagBox[
          GridBox[{{
             GraphicsBox[{
               RGBColor[0.237736, 0.340215, 0.575113], 
               EdgeForm[
                Opacity[0.7]], 
               RectangleBox[{0, 0}]}, ImageSize -> 10], "\"0\""}}, AutoDelete -> 
           False, GridBoxItemSize -> {
            "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}], "Grid"]}, {
        
         TagBox[
          GridBox[{{
             GraphicsBox[{
               RGBColor[0.264425, 0.423024, 0.3849], 
               EdgeForm[
                Opacity[0.7]], 
               RectangleBox[{0, 0}]}, ImageSize -> 10], "\"1\""}}, AutoDelete -> 
           False, GridBoxItemSize -> {
            "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}], "Grid"]}, {
        
         TagBox[
          GridBox[{{
             GraphicsBox[{
               RGBColor[0.416394, 0.555345, 0.24182], 
               EdgeForm[
                Opacity[0.7]], 
               RectangleBox[{0, 0}]}, ImageSize -> 10], "\"Ao\""}}, 
           AutoDelete -> False, 
           GridBoxItemSize -> {
            "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}], "Grid"]}, {
        
         TagBox[
          GridBox[{{
             GraphicsBox[{
               RGBColor[0.813033, 0.766292, 0.303458], 
               EdgeForm[
                Opacity[0.7]], 
               RectangleBox[{0, 0}]}, ImageSize -> 10], "\"Ap\""}}, 
           AutoDelete -> False, 
           GridBoxItemSize -> {
            "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}], "Grid"]}, {
        
         TagBox[
          GridBox[{{
             GraphicsBox[{
               RGBColor[0.812807, 0.518694, 0.303459], 
               EdgeForm[
                Opacity[0.7]], 
               RectangleBox[{0, 0}]}, ImageSize -> 10], "\"Bo\""}}, 
           AutoDelete -> False, 
           GridBoxItemSize -> {
            "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}], "Grid"]}, {
        
         TagBox[
          GridBox[{{
             GraphicsBox[{
               RGBColor[0.72987, 0.239399, 0.230961], 
               EdgeForm[
                Opacity[0.7]], 
               RectangleBox[{0, 0}]}, ImageSize -> 10], "\"Bp\""}}, 
           AutoDelete -> False, 
           GridBoxItemSize -> {
            "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}], "Grid"]}}, 
       GridBoxAlignment -> {"Columns" -> {{Left}}}, 
       GridBoxItemSize -> {
        "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}], "Column"], 
     "TR", StripOnInput -> False, ShowStringCharacters -> False], 
    StripOnInput -> False]},
  "Labeled",
  DisplayFunction->(GridBox[{{
      TagBox[
       ItemBox[
        PaneBox[
         TagBox[#, "SkipImageSizeLevel"], Alignment -> {Center, Baseline}, 
         BaselinePosition -> Baseline], DefaultBaseStyle -> "Labeled"], 
       "SkipImageSizeLevel"], 
      ItemBox[#2, DefaultBaseStyle -> "LabeledLabel"]}}, 
    GridBoxAlignment -> {"Columns" -> {{Center}}, "Rows" -> {{Center}}}, 
    AutoDelete -> False, 
    GridBoxItemSize -> {"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
    BaselinePosition -> {1, 1}]& ),
  InterpretationFunction->(RowBox[{"Labeled", "[", 
     RowBox[{#, ",", #2, ",", "Right"}], "]"}]& )]], "Output",
 CellChangeTimes->{{3.521307923983942*^9, 3.521307948355308*^9}, 
   3.5213083198262177`*^9, 3.521309246301167*^9, 3.521309277448193*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"target", " ", "=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{"0", ",", "1"}], "}"}], " ", ".4", " ", "m"}], " ", "//.", " ", 
   "params"}]}]], "Input",
 CellChangeTimes->{{3.521588356666264*^9, 3.521588375924946*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.`", ",", "0.4`"}], "}"}]], "Output",
 CellChangeTimes->{3.521588376741845*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"RK4StepSize", " ", "=", " ", "0.02"}], ";"}]], "Input",
 CellChangeTimes->{{3.521588492478785*^9, 3.521588497476829*^9}, {
  3.52158904547082*^9, 3.521589045916232*^9}, {3.521589195007922*^9, 
  3.5215892332524357`*^9}, {3.5215895386065702`*^9, 3.521589538908412*^9}, {
  3.521658374448441*^9, 3.521658374575943*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"target", " ", "=", " ", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0", ",", "1"}], "}"}], " ", "0.2"}]}]], "Input",
 CellChangeTimes->{{3.521658400167643*^9, 3.521658407223937*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.`", ",", "0.2`"}], "}"}]], "Output",
 CellChangeTimes->{{3.5216584014163446`*^9, 3.52165840795858*^9}, 
   3.521677412841386*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"gene", " ", "=", " ", 
   RowBox[{"importBestGenes", "[", 
    RowBox[{"\"\<speed-BAD-1.pop\>\"", ",", " ", "fitness"}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.521588339413457*^9, 3.521588351506332*^9}, 
   3.521588381519763*^9, {3.5215884818861837`*^9, 3.521588482605857*^9}, {
   3.5215888536725187`*^9, 3.5215888545026617`*^9}, {3.521589367824201*^9, 
   3.5215893686058292`*^9}, 3.521589534599478*^9, {3.521658360416967*^9, 
   3.521658365277595*^9}, 3.521658479558009*^9, 3.521677408017076*^9, {
   3.521677445714464*^9, 3.52167744728856*^9}, 3.523574721586011*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"importBestGenes", "::", "notuniq"}], "MessageName"], ":", 
  " ", "\<\"-- Message text not found --\"\>"}]], "Message", "MSG",
 GeneratedCell->False,
 CellAutoOverwrite->False,
 CellChangeTimes->{3.521677449108918*^9, 3.5216784685435553`*^9, 
  3.521678740822116*^9, 3.523574721586698*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"fitness", "[", "gene", "]"}]], "Input",
 CellChangeTimes->{{3.521678790478311*^9, 3.521678791959916*^9}}],

Cell[BoxData["666.6`"], "Output",
 CellChangeTimes->{{3.521678792361271*^9, 3.5216788206538067`*^9}}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"RK4StepSize", " ", "=", " ", "0.01"}], ";"}]], "Input",
 CellChangeTimes->{{3.5216776939977913`*^9, 3.521677700296032*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"fitness", "[", "gene", "]"}]], "Input",
 CellChangeTimes->{{3.521679298145753*^9, 3.5216793000621023`*^9}}],

Cell[BoxData["1.4961670271517615`"], "Output",
 CellChangeTimes->{
  3.521679300550467*^9, 3.5216933675436373`*^9, 3.522701833591008*^9, {
   3.5228636063524027`*^9, 3.5228636334349213`*^9}}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"data", " ", "=", " ", 
   RowBox[{"fitnessData", "[", "gene", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.5216793032272797`*^9, 3.521679307252721*^9}}],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"ran", " ", "a", " ", "mean", " ", "speed", " ", "test", " ", 
   RowBox[{"got", ":", " ", 
    RowBox[{
     RowBox[{"1.30", "e"}], "-", 
     RowBox[{
     "03", " ", "as", " ", "the", " ", "max", " ", "after", " ", "16", "k", 
      " ", 
      RowBox[{"evaluations", "."}]}]}]}]}], " ", "*)"}]], "Input",
 CellChangeTimes->{{3.5216820587597933`*^9, 3.521682083672142*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"link", " ", "=", " ", 
  RowBox[{"Install", "[", 
   RowBox[{"\"\<9\>\"", ",", " ", 
    RowBox[{"LinkMode", "\[Rule]", " ", "Connect"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.522703081717351*^9, 3.522703115340036*^9}, {
   3.522777158039104*^9, 3.5227771581237793`*^9}, {3.522777361342247*^9, 
   3.52277736142966*^9}, {3.5227779317341957`*^9, 3.522777931786994*^9}, {
   3.5227786000070333`*^9, 3.522778600124524*^9}, {3.522779103366705*^9, 
   3.522779103684163*^9}, {3.522779442167882*^9, 3.522779469926258*^9}, {
   3.5227797004697638`*^9, 3.522779700748837*^9}, {3.5227803312148933`*^9, 
   3.522780331500432*^9}, {3.522783631057643*^9, 3.522783631135745*^9}, {
   3.522783802402048*^9, 3.522783802494843*^9}, {3.5227841410818233`*^9, 
   3.5227841411750937`*^9}, {3.522784633520823*^9, 3.5227846336307583`*^9}, {
   3.522785400481803*^9, 3.5227854005828238`*^9}, {3.5227858111630173`*^9, 
   3.5227858116084137`*^9}, {3.522785934161293*^9, 3.52278593443167*^9}, {
   3.522785998112898*^9, 3.522785998400126*^9}, {3.522786102084404*^9, 
   3.522786102408505*^9}, {3.522786211539172*^9, 3.522786211934842*^9}, {
   3.52278633273076*^9, 3.522786334111514*^9}, {3.522786567227005*^9, 
   3.5227865672903767`*^9}, {3.522787629248775*^9, 3.5227876293090963`*^9}, {
   3.522787707347331*^9, 3.522787707431409*^9}, {3.522788035906312*^9, 
   3.522788035958741*^9}, {3.522788122170393*^9, 3.522788122462908*^9}, {
   3.5227882770328207`*^9, 3.522788277280328*^9}, {3.522795065953682*^9, 
   3.522795066020348*^9}, {3.522795205624627*^9, 3.5227952057351227`*^9}, {
   3.52279536130499*^9, 3.522795361358651*^9}, {3.5227955540989122`*^9, 
   3.5227955541845093`*^9}, {3.522795647570711*^9, 3.522795649175231*^9}, {
   3.5228634978414516`*^9, 3.5228634982791758`*^9}, {3.523232479274857*^9, 
   3.523232479560604*^9}, {3.52323257698809*^9, 3.5232325894634113`*^9}, {
   3.52323262861211*^9, 3.523232628737236*^9}, {3.5234460835859613`*^9, 
   3.523446083664838*^9}, 3.523508271331118*^9, {3.5235101247361794`*^9, 
   3.523510124822949*^9}, {3.5235105065601892`*^9, 3.523510506687428*^9}, {
   3.523510643058577*^9, 3.5235106431675043`*^9}, {3.523511172522113*^9, 
   3.523511172903319*^9}, {3.523511378876216*^9, 3.523511380168103*^9}, {
   3.523511590081641*^9, 3.523511590407544*^9}}],

Cell[BoxData[
 RowBox[{"LinkObject", "[", 
  RowBox[{"\<\"9\"\>", ",", "8895", ",", "8"}], "]"}]], "Output",
 CellChangeTimes->{
  3.522703106836515*^9, 3.522777158568778*^9, 3.5227773617317867`*^9, 
   3.522777932223536*^9, 3.522778600805396*^9, 3.522779104053317*^9, {
   3.5227794430796757`*^9, 3.5227794702792673`*^9}, 3.5227797011912603`*^9, 
   3.522780331900713*^9, 3.522783631487385*^9, 3.522783802847052*^9, 
   3.522784146585804*^9, 3.5227846343835993`*^9, 3.52278540100377*^9, 
   3.522785822938995*^9, 3.5227859348448553`*^9, 3.522785998733286*^9, 
   3.52278610862504*^9, 3.522786217739298*^9, 3.522786334491239*^9, 
   3.5227865679746532`*^9, 3.5227876296841497`*^9, 3.522787707794471*^9, 
   3.5227880363091717`*^9, 3.522788123175915*^9, 3.522788277597513*^9, 
   3.5227950663669453`*^9, 3.522795212478643*^9, 3.522795361626511*^9, 
   3.522795555790077*^9, 3.522795649573873*^9, 3.5228634988773203`*^9, 
   3.523230132690374*^9, 3.523232479952146*^9, {3.523232577606874*^9, 
   3.523232638131589*^9}, 3.523446084235093*^9, 3.523508272263324*^9, 
   3.5235101252448893`*^9, 3.5235105072663*^9, 3.5235106435394783`*^9, 
   3.523511173341124*^9, 3.523511380522361*^9, 3.523511590791399*^9, 
   3.523515359714135*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Uninstall", "[", "link", "]"}]], "Input",
 CellChangeTimes->{{3.522703178707307*^9, 3.522703181784876*^9}, {
  3.522777184772064*^9, 3.522777186147921*^9}}],

Cell[BoxData["\<\"9\"\>"], "Output",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmVkYGDQBOJvv469ZLV/5Tg7JZhHC0j3rS6OB9GBipt2gehrae/u
gehbQbqq2kA6paxzCoi25PqurwsSnyfkBqLLCjILQfSW/+949UD8z8xOIFqC
szgARHvufRYBohm4WtNAdE6WbgmIjpqX2QSiZRIsFoDoaW9fqeiDzK07rgei
O7kvhYNo8VSfJBAtcbqmFEQX2DrXg+gHpe43jEDqM8Jeg+jld1qZjYH0Uh9B
fhC9/UK0DIhe4fVdNwRIaxx7FcXh8MrRzF0qHURfkG5ZXgCk11j2vegH0lwZ
QTITgPQCbhVdEL3ofmM+iI6vLu0E0bc2VC4G0Tzssn8mAmn+d3mm64E0AN8O
kkc=
  "]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"runSimulationMlink", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"{", "0", "}"}], "~", "Join", "~", 
    RowBox[{"Table", "[", 
     RowBox[{"0.", ",", " ", 
      RowBox[{"{", 
       RowBox[{"stateCount", " ", "-", " ", "1"}], "}"}]}], "]"}]}], ",", " ",
    "0.01", ",", " ", 
   RowBox[{"Table", "[", 
    RowBox[{".5", ",", " ", 
     RowBox[{"{", "constantsCount", "}"}]}], "]"}], ",", "10."}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.522777934554111*^9, 3.522777974796489*^9}, {
   3.522778619293846*^9, 3.522778623844037*^9}, {3.522779108971455*^9, 
   3.522779157142495*^9}, {3.522779220639421*^9, 3.522779224317017*^9}, {
   3.522779708926272*^9, 3.522779719717588*^9}, {3.522779751701663*^9, 
   3.5227797650374537`*^9}, {3.522780254558818*^9, 3.522780275973165*^9}, {
   3.522780337223625*^9, 3.522780342623311*^9}, {3.522783643954196*^9, 
   3.522783650545476*^9}, 3.522783808133329*^9, 3.522784640367889*^9, {
   3.522784900313182*^9, 3.522784964672666*^9}, 3.52278499468934*^9, {
   3.522785263377898*^9, 3.522785265360002*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "10.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
   "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
   "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
   "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
   "7.0710678118654755`", ",", "0.`"}], "}"}]], "Output",
 CellChangeTimes->{{3.522777946949861*^9, 3.522777975124004*^9}, 
   3.5227786244175*^9, {3.522779105907755*^9, 3.522779158286408*^9}, 
   3.522779225039641*^9, 3.5227794452955503`*^9, 3.522779520167959*^9, {
   3.522779704564948*^9, 3.522779720236484*^9}, {3.522779752316135*^9, 
   3.522779765370359*^9}, {3.52278024467514*^9, 3.522780276258218*^9}, {
   3.522780334192045*^9, 3.5227803430934887`*^9}, {3.52278363377485*^9, 
   3.522783650894834*^9}, {3.5227838060322123`*^9, 3.522783808755406*^9}, 
   3.522784150271956*^9, {3.522784637634454*^9, 3.522784640721713*^9}, {
   3.522784900957223*^9, 3.522784964999995*^9}, 3.5227849951557426`*^9, 
   3.522785265772719*^9, 3.5227950694922256`*^9, 3.523231574611465*^9, {
   3.5234461125418167`*^9, 3.5234461232868567`*^9}}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"NestList", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"runSimulationMlink", "[", 
     RowBox[{"#", ",", " ", "0.01", ",", " ", 
      RowBox[{"Table", "[", 
       RowBox[{".5", ",", " ", 
        RowBox[{"{", "constantsCount", "}"}]}], "]"}], ",", "0.1"}], "]"}], 
    "&"}], ",", " ", 
   RowBox[{
    RowBox[{"{", "0", "}"}], "~", "Join", "~", 
    RowBox[{"Table", "[", 
     RowBox[{"0.", ",", " ", 
      RowBox[{"{", 
       RowBox[{"stateCount", " ", "-", " ", "1"}], "}"}]}], "]"}]}], ",", " ",
    "10"}], "]"}]], "Input",
 CellChangeTimes->{{3.522777934554111*^9, 3.522777974796489*^9}, {
   3.522778619293846*^9, 3.522778623844037*^9}, {3.522779108971455*^9, 
   3.522779157142495*^9}, {3.522779220639421*^9, 3.522779224317017*^9}, {
   3.522779708926272*^9, 3.522779719717588*^9}, {3.522779751701663*^9, 
   3.5227797650374537`*^9}, {3.522780254558818*^9, 3.522780275973165*^9}, {
   3.522780337223625*^9, 3.522780342623311*^9}, {3.522783643954196*^9, 
   3.522783650545476*^9}, 3.522783808133329*^9, 3.522784640367889*^9, {
   3.522784900313182*^9, 3.522784964672666*^9}, 3.52278499468934*^9, {
   3.522785263377898*^9, 3.5227853541452923`*^9}, {3.5227854093702917`*^9, 
   3.522785410097453*^9}}],

Cell[BoxData[
 RowBox[{"NestList", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"runSimulationMlink", "[", 
     RowBox[{"#", ",", " ", "0.01", ",", " ", 
      RowBox[{"Table", "[", 
       RowBox[{".5", ",", " ", 
        RowBox[{"{", "constantsCount", "}"}]}], "]"}], ",", "0.1"}], "]"}], 
    "&"}], ",", " ", 
   RowBox[{
    RowBox[{"{", "0", "}"}], "~", "Join", "~", 
    RowBox[{"Table", "[", 
     RowBox[{"0.", ",", " ", 
      RowBox[{"{", 
       RowBox[{"stateCount", " ", "-", " ", "1"}], "}"}]}], "]"}]}], ",", " ",
    "10"}], "]"}]], "Input",
 CellChangeTimes->{{3.522777934554111*^9, 3.522777974796489*^9}, {
   3.522778619293846*^9, 3.522778623844037*^9}, {3.522779108971455*^9, 
   3.522779157142495*^9}, {3.522779220639421*^9, 3.522779224317017*^9}, {
   3.522779708926272*^9, 3.522779719717588*^9}, {3.522779751701663*^9, 
   3.5227797650374537`*^9}, {3.522780254558818*^9, 3.522780275973165*^9}, {
   3.522780337223625*^9, 3.522780342623311*^9}, {3.522783643954196*^9, 
   3.522783650545476*^9}, 3.522783808133329*^9, 3.522784640367889*^9, {
   3.522784900313182*^9, 3.522784964672666*^9}, 3.52278499468934*^9, {
   3.522785263377898*^9, 3.5227853541452923`*^9}, {3.5227854093702917`*^9, 
   3.522785410097453*^9}, 3.5227881270534477`*^9}],

Cell[BoxData[
 RowBox[{"NestList", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"runSimulationMlink", "[", 
     RowBox[{"#", ",", " ", "0.01", ",", " ", 
      RowBox[{"Table", "[", 
       RowBox[{".5", ",", " ", 
        RowBox[{"{", "constantsCount", "}"}]}], "]"}], ",", "0.1"}], "]"}], 
    "&"}], ",", " ", 
   RowBox[{
    RowBox[{"{", "0", "}"}], "~", "Join", "~", 
    RowBox[{"Table", "[", 
     RowBox[{"0.", ",", " ", 
      RowBox[{"{", 
       RowBox[{"stateCount", " ", "-", " ", "1"}], "}"}]}], "]"}]}], ",", " ",
    "10"}], "]"}]], "Input",
 CellChangeTimes->{{3.522777934554111*^9, 3.522777974796489*^9}, {
   3.522778619293846*^9, 3.522778623844037*^9}, {3.522779108971455*^9, 
   3.522779157142495*^9}, {3.522779220639421*^9, 3.522779224317017*^9}, {
   3.522779708926272*^9, 3.522779719717588*^9}, {3.522779751701663*^9, 
   3.5227797650374537`*^9}, {3.522780254558818*^9, 3.522780275973165*^9}, {
   3.522780337223625*^9, 3.522780342623311*^9}, {3.522783643954196*^9, 
   3.522783650545476*^9}, 3.522783808133329*^9, 3.522784640367889*^9, {
   3.522784900313182*^9, 3.522784964672666*^9}, 3.52278499468934*^9, {
   3.522785263377898*^9, 3.5227853541452923`*^9}, {3.5227854093702917`*^9, 
   3.522785410097453*^9}, 3.5227881270534477`*^9, 3.52278828161344*^9}],

Cell[BoxData[
 RowBox[{"NestList", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"runSimulation", "[", 
     RowBox[{"#", ",", " ", "0.01", ",", " ", 
      RowBox[{"Table", "[", 
       RowBox[{".5", ",", " ", 
        RowBox[{"{", "constantsCount", "}"}]}], "]"}], ",", "0.1"}], "]"}], 
    "&"}], ",", " ", 
   RowBox[{
    RowBox[{"{", "0", "}"}], "~", "Join", "~", 
    RowBox[{"Table", "[", 
     RowBox[{"0.", ",", " ", 
      RowBox[{"{", 
       RowBox[{"stateCount", " ", "-", " ", "1"}], "}"}]}], "]"}]}], ",", " ",
    "10"}], "]"}]], "Input",
 CellChangeTimes->{{3.522777934554111*^9, 3.522777974796489*^9}, {
   3.522778619293846*^9, 3.522778623844037*^9}, {3.522779108971455*^9, 
   3.522779157142495*^9}, {3.522779220639421*^9, 3.522779224317017*^9}, {
   3.522779708926272*^9, 3.522779719717588*^9}, {3.522779751701663*^9, 
   3.5227797650374537`*^9}, {3.522780254558818*^9, 3.522780275973165*^9}, {
   3.522780337223625*^9, 3.522780342623311*^9}, {3.522783643954196*^9, 
   3.522783650545476*^9}, 3.522783808133329*^9, 3.522784640367889*^9, {
   3.522784900313182*^9, 3.522784964672666*^9}, 3.52278499468934*^9, {
   3.522785263377898*^9, 3.5227853541452923`*^9}, {3.5227854093702917`*^9, 
   3.522785410097453*^9}, {3.5227878955124598`*^9, 3.522787898016333*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"gene", " ", "=", " ", 
   RowBox[{"initGene", "[", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.522863546379507*^9, 3.5228635532388153`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"fitness", "[", "gene", "]"}]], "Input",
 CellChangeTimes->{{3.522783283016086*^9, 3.522783284950336*^9}}],

Cell[BoxData["1.4375465596099277`"], "Output",
 CellChangeTimes->{
  3.522783285448968*^9, 3.522788215459137*^9, 3.522795117527092*^9, 
   3.522795216690765*^9, {3.522795399029738*^9, 3.5227954133081636`*^9}, 
   3.522795559322351*^9, 3.5227955895085707`*^9, 3.5227956697783213`*^9, 
   3.5228635071541986`*^9, {3.522863555039762*^9, 3.522863585079114*^9}, 
   3.5228636553684196`*^9, 3.523231603447749*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Block", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"runSimulationGA", " ", "=", " ", "runSimulation"}], "}"}], ",", 
   " ", 
   RowBox[{"fitness", "[", "gene", "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.523231642827509*^9, 3.523231643393716*^9}}],

Cell[BoxData["1.6554037639973382`"], "Output",
 CellChangeTimes->{3.523231643783554*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Block", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"runSimulationGA", " ", "=", " ", "runSimulationMlink"}], "}"}], 
   ",", " ", 
   RowBox[{"fitness", "[", "gene", "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.522783283016086*^9, 3.522783284950336*^9}, {
  3.522783357872889*^9, 3.522783369871554*^9}, {3.5227835171706533`*^9, 
  3.522783518190535*^9}, {3.522783848560961*^9, 3.522783851264057*^9}, {
  3.523231632834223*^9, 3.523231632913711*^9}}],

Cell[BoxData["1.4375465596099277`"], "Output",
 CellChangeTimes->{
  3.522783852060503*^9, 3.522784156334203*^9, 3.522784647282034*^9, 
   3.522795121097562*^9, 3.522795219783462*^9, {3.5227954011718597`*^9, 
   3.5227954151945343`*^9}, {3.522795561002413*^9, 3.522795590958543*^9}, 
   3.522795670802024*^9, 3.522863508526663*^9, 3.522863556602808*^9, 
   3.5228636568312683`*^9, {3.523231605471653*^9, 3.523231633386086*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Timing", "[", 
  RowBox[{
   RowBox[{"data", " ", "=", " ", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"runSimulationGA", " ", "=", " ", "runSimulationMlink"}], 
       "}"}], ",", " ", 
      RowBox[{"fitnessData", "[", "gene", "]"}]}], "]"}]}], ";"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.522783283016086*^9, 3.522783284950336*^9}, {
  3.522783357872889*^9, 3.522783369871554*^9}, {3.5227835171706533`*^9, 
  3.522783518190535*^9}, {3.5227841607131042`*^9, 3.5227841617830973`*^9}, {
  3.5227857636184607`*^9, 3.522785764854664*^9}, {3.523231618890822*^9, 
  3.523231618969234*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.014270000000010441`", ",", "Null"}], "}"}]], "Output",
 CellChangeTimes->{
  3.522785765585347*^9, 3.522785837672484*^9, 3.522785940752674*^9, 
   3.522786007070417*^9, 3.522786121356215*^9, 3.522786224844223*^9, 
   3.522786341017475*^9, 3.5227865759565487`*^9, 3.5227876442742443`*^9, 
   3.522787713104494*^9, 3.522788147039875*^9, 3.522788310315939*^9, 
   3.522795132561747*^9, 3.522795227802691*^9, 3.522795365851349*^9, 
   3.52279541787827*^9, 3.522795594051783*^9, 3.522795686949554*^9, 
   3.522863511903034*^9, 3.522863660078969*^9, {3.523231613169191*^9, 
   3.523231620328765*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Timing", "[", 
  RowBox[{
   RowBox[{"data2", " ", "=", " ", 
    RowBox[{"fitnessData", "[", "gene", "]"}]}], ";"}], "]"}]], "Input",
 CellChangeTimes->{{3.522783283016086*^9, 3.522783284950336*^9}, {
  3.522783357872889*^9, 3.522783369871554*^9}, {3.5227835171706533`*^9, 
  3.522783518190535*^9}, {3.5227841607131042`*^9, 3.5227841617830973`*^9}, {
  3.5227857017924*^9, 3.522785711015747*^9}, {3.5227857701172733`*^9, 
  3.522785771454356*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.013953999999955613`", ",", "Null"}], "}"}]], "Output",
 CellChangeTimes->{3.522785771920436*^9, 3.5227858392232437`*^9, 
  3.5227860549992247`*^9, 3.522788195330834*^9, 3.522795134349099*^9, 
  3.522795419072671*^9, 3.522795720561438*^9, 3.522863512867559*^9, 
  3.522863661264223*^9, 3.523231623679613*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"processCollision", "[", 
   RowBox[{"Array", "[", 
    RowBox[{"s", ",", "stateCount"}], "]"}], "]"}], " ", "/.", " ", 
  RowBox[{
   RowBox[{"s", "[", "a_", "]"}], " ", "\[Rule]", " ", 
   RowBox[{"s", "[", 
    RowBox[{"a", " ", "-", " ", "1"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.522795307573258*^9, 3.522795325830739*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"s", "[", "0", "]"}], ",", 
   RowBox[{"s", "[", "1", "]"}], ",", 
   RowBox[{"s", "[", "2", "]"}], ",", 
   RowBox[{"s", "[", "3", "]"}], ",", 
   RowBox[{"s", "[", "4", "]"}], ",", 
   RowBox[{"s", "[", "5", "]"}], ",", 
   RowBox[{"s", "[", "6", "]"}], ",", 
   RowBox[{"s", "[", "7", "]"}], ",", 
   RowBox[{"s", "[", "8", "]"}], ",", 
   RowBox[{"s", "[", "9", "]"}], ",", 
   RowBox[{"s", "[", "10", "]"}], ",", 
   RowBox[{"s", "[", "11", "]"}], ",", 
   RowBox[{
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"s", "[", "4", "]"}], ">", 
          FractionBox["\[Pi]", "2"]}], "&&", 
         RowBox[{
          RowBox[{"s", "[", "12", "]"}], ">", "0"}]}], ")"}], "||", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"s", "[", "4", "]"}], "<", 
          RowBox[{"-", 
           FractionBox["\[Pi]", "2"]}]}], "&&", 
         RowBox[{
          RowBox[{"s", "[", "12", "]"}], "<", "0"}]}], ")"}]}], ",", 
      RowBox[{"-", "0.8`"}], ",", "1"}], "]"}], " ", 
    RowBox[{"s", "[", "12", "]"}]}], ",", 
   RowBox[{
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"s", "[", "5", "]"}], ">", 
          FractionBox["\[Pi]", "2"]}], "&&", 
         RowBox[{
          RowBox[{"s", "[", "13", "]"}], ">", "0"}]}], ")"}], "||", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"s", "[", "5", "]"}], "<", 
          RowBox[{"-", 
           FractionBox["\[Pi]", "2"]}]}], "&&", 
         RowBox[{
          RowBox[{"s", "[", "13", "]"}], "<", "0"}]}], ")"}]}], ",", 
      RowBox[{"-", "0.8`"}], ",", "1"}], "]"}], " ", 
    RowBox[{"s", "[", "13", "]"}]}], ",", 
   RowBox[{
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"s", "[", "6", "]"}], ">", 
          FractionBox["\[Pi]", "2"]}], "&&", 
         RowBox[{
          RowBox[{"s", "[", "14", "]"}], ">", "0"}]}], ")"}], "||", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"s", "[", "6", "]"}], "<", 
          RowBox[{"-", 
           FractionBox["\[Pi]", "2"]}]}], "&&", 
         RowBox[{
          RowBox[{"s", "[", "14", "]"}], "<", "0"}]}], ")"}]}], ",", 
      RowBox[{"-", "0.8`"}], ",", "1"}], "]"}], " ", 
    RowBox[{"s", "[", "14", "]"}]}], ",", 
   RowBox[{
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"s", "[", "7", "]"}], ">", 
          FractionBox["\[Pi]", "2"]}], "&&", 
         RowBox[{
          RowBox[{"s", "[", "15", "]"}], ">", "0"}]}], ")"}], "||", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"s", "[", "7", "]"}], "<", 
          RowBox[{"-", 
           FractionBox["\[Pi]", "2"]}]}], "&&", 
         RowBox[{
          RowBox[{"s", "[", "15", "]"}], "<", "0"}]}], ")"}]}], ",", 
      RowBox[{"-", "0.8`"}], ",", "1"}], "]"}], " ", 
    RowBox[{"s", "[", "15", "]"}]}], ",", 
   RowBox[{
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"s", "[", "8", "]"}], ">", 
          FractionBox["\[Pi]", "2"]}], "&&", 
         RowBox[{
          RowBox[{"s", "[", "16", "]"}], ">", "0"}]}], ")"}], "||", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"s", "[", "8", "]"}], "<", 
          RowBox[{"-", 
           FractionBox["\[Pi]", "2"]}]}], "&&", 
         RowBox[{
          RowBox[{"s", "[", "16", "]"}], "<", "0"}]}], ")"}]}], ",", 
      RowBox[{"-", "0.8`"}], ",", "1"}], "]"}], " ", 
    RowBox[{"s", "[", "16", "]"}]}], ",", 
   RowBox[{"s", "[", "17", "]"}], ",", 
   RowBox[{"s", "[", "18", "]"}], ",", 
   RowBox[{"s", "[", "19", "]"}], ",", 
   RowBox[{"s", "[", "20", "]"}], ",", 
   RowBox[{"s", "[", "21", "]"}], ",", 
   RowBox[{"s", "[", "22", "]"}], ",", 
   RowBox[{"s", "[", "23", "]"}], ",", 
   RowBox[{"s", "[", "24", "]"}], ",", 
   RowBox[{"s", "[", "25", "]"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.522795316962685*^9, 3.5227953262426653`*^9}}]
}, Open  ]]
}, Open  ]]
},
WindowSize->{836, 568},
WindowMargins->{{Automatic, 92}, {19, Automatic}},
ShowSelection->True,
FrontEndVersion->"8.0 for Mac OS X x86 (32-bit, 64-bit Kernel) (February 23, \
2011)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[579, 22, 89, 1, 76, "Title"],
Cell[671, 25, 520, 13, 27, "Input"],
Cell[1194, 40, 469, 12, 27, "Input"],
Cell[1666, 54, 878, 19, 73, "Input"],
Cell[2547, 75, 1171, 26, 58, "Input"],
Cell[3721, 103, 940, 22, 73, "Input"],
Cell[4664, 127, 1134, 32, 73, "Input"],
Cell[5801, 161, 631, 16, 43, "Input"],
Cell[6435, 179, 811, 21, 73, "Input"],
Cell[7249, 202, 864, 22, 73, "Input"],
Cell[8116, 226, 1390, 33, 118, "Input"],
Cell[9509, 261, 1416, 33, 118, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[10962, 299, 97, 1, 76, "Title"],
Cell[CellGroupData[{
Cell[11084, 304, 233, 5, 27, "Input"],
Cell[11320, 311, 142, 3, 27, "Output"]
}, Open  ]],
Cell[11477, 317, 691, 16, 43, "Input"],
Cell[12171, 335, 740, 17, 43, "Input"],
Cell[12914, 354, 520, 14, 43, "Input"],
Cell[13437, 370, 569, 15, 43, "Input"],
Cell[CellGroupData[{
Cell[14031, 389, 146, 2, 27, "Input"],
Cell[14180, 393, 9808, 252, 227, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[24025, 650, 260, 7, 27, "Input"],
Cell[24288, 659, 120, 3, 27, "Output"]
}, Open  ]],
Cell[24423, 665, 352, 6, 27, "Input"],
Cell[CellGroupData[{
Cell[24800, 675, 204, 5, 27, "Input"],
Cell[25007, 682, 171, 4, 27, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[25215, 691, 617, 11, 27, "Input"],
Cell[25835, 704, 337, 8, 23, "Message"]
}, Open  ]],
Cell[CellGroupData[{
Cell[26209, 717, 129, 2, 27, "Input"],
Cell[26341, 721, 101, 1, 27, "Output"]
}, Open  ]],
Cell[26457, 725, 158, 3, 27, "Input"],
Cell[CellGroupData[{
Cell[26640, 732, 131, 2, 27, "Input"],
Cell[26774, 736, 191, 3, 27, "Output"]
}, Open  ]],
Cell[26980, 742, 190, 4, 27, "Input"],
Cell[27173, 748, 421, 10, 27, "Input"],
Cell[CellGroupData[{
Cell[27619, 762, 2310, 33, 27, "Input"],
Cell[29932, 797, 1229, 19, 27, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[31198, 821, 180, 3, 27, "Input"],
Cell[31381, 826, 450, 9, 27, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[31868, 840, 1066, 22, 43, "Input"],
Cell[32937, 864, 1175, 18, 27, "Output"]
}, Open  ]],
Cell[34127, 885, 1234, 26, 43, "Input"],
Cell[35364, 913, 1258, 26, 43, "Input"],
Cell[36625, 941, 1279, 26, 43, "Input"],
Cell[37907, 969, 1277, 26, 43, "Input"],
Cell[39187, 997, 179, 4, 27, "Input"],
Cell[CellGroupData[{
Cell[39391, 1005, 129, 2, 27, "Input"],
Cell[39523, 1009, 407, 6, 27, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[39967, 1020, 279, 7, 27, "Input"],
Cell[40249, 1029, 88, 1, 27, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[40374, 1035, 479, 10, 27, "Input"],
Cell[40856, 1047, 427, 6, 27, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[41320, 1058, 647, 15, 27, "Input"],
Cell[41970, 1075, 636, 11, 27, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[42643, 1091, 472, 9, 27, "Input"],
Cell[43118, 1102, 349, 6, 27, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[43504, 1113, 369, 9, 27, "Input"],
Cell[43876, 1124, 4251, 129, 229, "Output"]
}, Open  ]]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
